<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
  <h1>Sticky Notes App</h1>
  
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      background-color: #eee;
    }

    #container {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 1rem;
    }

    textarea { 
      padding: 1rem;
      height: 10rem;
      resize: none;
      border: none;
      outline: none;
    }
    
    #add-btn {
      font-size: 4rem;
      height: 10rem;
      background-color: rgba(0 0 0 / 0.1);
      border: none;
      cursor: pointer;
      color: #fff;
    }

    #add-btn:hover {
      background-color: rgba(0 0 0 / 0.2);
    }
  </style>


  <div id="container">
    <button id="add-btn">+</button>
  </div>

  <script>
    let addBtn = document.getElementById('add-btn');
    let container = document.getElementById('container');

    window.addEventListener('DOMContentLoaded', getNotes);
    addBtn.addEventListener('click', addNote);

    function createNoteElement(id, content) {

      let NoteElement = document.createElement('textarea');

      NoteElement.value = content;
      NoteElement.addEventListener('change', (e) => editNote(id, e.target.value));
      NoteElement.addEventListener('dblclick', (e) => deleteNote(e.target, id));

      container.insertBefore(NoteElement, addBtn);
    }
    
    function getDocs() {
      return JSON.parse(localStorage.getItem('notesStorage'));
    }

    function saveDoc(notes) {
      localStorage.setItem('notesStorage', JSON.stringify(notes));
    }

    function getNotes(e) {

      if (!localStorage.getItem('notesStorage')) {
        localStorage.setItem('notesStorage', '[]');
      }

      let initialNotes = getDocs();

      for (let i = 0; i < initialNotes.length; i++) {
        createNoteElement(initialNotes[i].id, initialNotes[i].content);
      }
    }

    function addNote(e) {

      let notes = getDocs();
    
      let newNote = { id: 'n' + Date.now(), content: '' };

      let updateNotes = [...notes, newNote];
      saveDoc(updateNotes);
      
      createNoteElement(newNote.id, newNote.content);
    }

    function editNote(id, content) {

      let notes = getDocs();

      let updatedNotes = notes.map(note => {
        if (note.id === id) {
          return { ...note, content }
        }
        return note;
      })

      saveDoc(updatedNotes);
    }

    function deleteNote(NoteElement, id) {

      let notes = getDocs();

      let remainingNotes = notes.filter(note => id !== note.id);
      saveDoc(remainingNotes);

      container.removeChild(NoteElement);
    }
  </script>
  
</body>
</html>