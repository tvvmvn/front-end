<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    nav {
      position: fixed;
      padding: 0 1rem;
      top: 0;
      left: 0;
      width: 250px;
      height: 100vh;
    }

    .title {
      text-align: center;
      margin: 2rem 0;
    }

    .filter-group {
      margin: 1rem 0;
    }

    label {
      display: block;
      font-weight: 600;
    }

    .filter-input {
      width: 100%;
    }

    main {
      margin-left: 250px;
      padding: 4rem;
      height: 100vh;
      background-color: #333;
      overflow: auto;
    }
  </style>

  <nav>
    <h1 class="title">JS Image Editor &#127912;</h1>

    <div class="filter-group">
      <label for="brightness">Brigtness</label>
      <input type="range" name="brightness" id="brightness" class="filter-input" min="0" max="200" value="100"
        oninput="setFilter(this)">
      <p class="filter-value">100</p>
    </div>

    <div class="filter-group">
      <label for="saturate">Saturate</label>
      <input type="range" name="saturate" id="saturate" class="filter-input" min="0" max="200" value="100"
        oninput="setFilter(this)">
      <p class="filter-value">100</p>
    </div>

    <div class="filter-group">
      <label for="invert">Invert</label>
      <input type="range" name="invert" id="invert" class="filter-input" min="0" max="100" value="0"
        oninput="setFilter(this)">
      <p class="filter-value">0</p>
    </div>

    <div class="filter-group">
      <label for="blur">Blur</label>
      <input type="range" name="blur" id="blur" class="filter-input" min="0" max="10" value="0"
        oninput="setFilter(this)">
      <p class="filter-value">0</p>
    </div>
  </nav>

  <main>
    <canvas id="canvas"></canvas>
  </main>

  <script>
    /*
      # canvas
      
      draw graphic in document using js.
      e.g) data visualization, photo manipulation, animation, game.
    */
   
    var canvas = document.getElementById('canvas');
    // pen
    var ctx = canvas.getContext('2d');
    var UNIT = {
      brightness: '%',
      saturate: '%',
      invert: '%',
      blur: 'px',
    }
    var filter = {};
    var imgElement = new Image();
    imgElement.src = "../../../../img/homies.jpg";


    imgElement.addEventListener("load", function () {
      canvas.width = imgElement.naturalWidth;
      canvas.height = imgElement.naturalHeight;

      render();
    });

    
    // input event
    function setFilter(input) {
      console.log(input);

      var name = input.name;
      var value = input.value;

      filter[name] = value + UNIT[name];

      // filter object
      console.log(filter);

      // change filter data to string for canvas API
      var filterInString = "";

      for (var key in filter) {
        filterInString += `${key}(${filter[key]}) `;
      }

      console.log(filterInString);

      // apply filter to image (canvas)
      ctx.filter = filterInString.trim();

      render();

      // numeric filter value below input
      input.nextElementSibling.textContent = value;
    }

    function render() {
      // drawImage(image element, left, top)
      ctx.drawImage(imgElement, 0, 0);
    }
  </script>

</body>

</html>